-- Adds porcentaje_ganancia to tortas and precio_lista to lista_precios\nSTART TRANSACTION;\n\nALTER TABLE tortas\n  ADD COLUMN porcentaje_ganancia FLOAT NOT NULL DEFAULT 0 AFTER descripcion_torta;\n\nALTER TABLE lista_precios\n  ADD COLUMN precio_lista FLOAT NOT NULL DEFAULT 0 AFTER costo_total;\n\nUPDATE lista_precios lp\nJOIN tortas t ON t.ID_TORTA = lp.id_torta\nSET lp.precio_lista = lp.costo_total * (1 + COALESCE(t.porcentaje_ganancia, 0) / 100);\n\nCOMMIT;
